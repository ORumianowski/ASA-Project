par(mfrow=c(1,2))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
####
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
####
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
####
plot.new()
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(readxl)
library(vegan)
library(dplyr)
library(ggplot2)
library(corrplot)
library(PerformanceAnalytics)
library(ade4)
Path = "data_vegetation_french.xls"
data_flower <- read_xls(Path, sheet = "flo")
data_environment <- read_xls(Path, sheet = "mil") %>%
lapply(as.numeric) %>%
as.data.frame()
colnames(data_environment) <- c("Argile","Limon","Sable","K2O","Mg", "Na_100g","K", "Conduc","Capa_Reten","Na_Liter","Altitude"  )
data_coordinate <- read_xls(Path, sheet = "coord") %>%
lapply(as.numeric) %>%
as.data.frame()
data_association <- read_xls(Path, sheet = "association")
summary(data_association)
summary(data_coordinate)
summary(data_flower[, 1:3])
summary(data_environment)
#ok
colSums(is.na(data_flower))
colSums(is.na(data_environment))
#ok
apply(data_flower, 1, sum)
#ok
par(mfrow=c(2,2))
for (i in 1:ncol(data_environment)) {
boxplot(data_environment[,i],col='blue',ylab=colnames(data_environment)[i])
dotchart(data_environment[,i],pch=16,col='blue',xlab=colnames(data_environment)[i])
hist(data_environment[,i],col='blue',xlab=colnames(data_environment)[i], main = "")
qqnorm(data_environment[,i],pch=16,col='blue')
qqline(data_environment[,i],col='red')
}
#matrice de corrélation des variables environnementales
chart.Correlation(data_environment)
boxplot(data_environment$Conduc~as.factor(data_environment$Altitude),
ylab = "Conductivité",
xlab = "Altitude")
data_environment <- data_environment[,-c(1,6,10)]
#data_environment <- data_environment[,- 8]
data_environment <- scale(data_environment,center = T, scale = T)
barplot(table(as.vector(unlist(as.vector(data_flower)))), xlab = "Abondance", ylab = "Fréquence", col = "blue")
hist(apply(data_flower, 1, sum),col='blue', main="", xlab = "Total de plantes par station")
hist(apply(data_flower, 2, sum),col='blue', main="", xlab = "Nombre d'individus d'une même espèce (toute station confondue)")
data_flower <- decostand(data_flower, "hellinger")
plot(data_coordinate)
# Calcul de la matrice de distance spatiale
matrice_spatial <- dist(data_coordinate) # Matrice spatiale
# Calcul de la matrice de distance du milieu (standardisée)
matrice_env<- dist(data_environment, method = "euclidean") # Matrice du milieu
# Test de Mantel
R <- mantel.randtest(matrice_spatial, matrice_env, nrepet = 10000)
# Affichage des résultats
R # p-value: 0.1418581, Observation: 0.04313656
plot(R, main = "Test de Mantel")
data_environmentAndCoord = cbind(data_environment, data_coordinate)
formule_pcca <- formula(paste("data_flower ~",                              paste(names(data_environmentAndCoord)[1:(length(data_environmentAndCoord)-(length(data_coordinate)))], collapse = " + "), "+ Condition (", paste(names(data_environmentAndCoord)[(length(data_environmentAndCoord)-(length(data_coordinate)-1)):length(data_environmentAndCoord)], collapse ="+"),")"))
print(formule_pcca)
pccaModel <- cca(formule_pcca, data_environmentAndCoord,scan=F)
ordistep(pccaModel,perm.max=500)
formulePcca_finale = formula("data_flower ~ Sable + Mg + K + Conduc + Capa_Reten + Altitude +
Condition(x + y)")
pccaModel_finale <- cca(formulePcca_finale, data_environmentAndCoord,scan=F)
vif.cca(pccaModel_finale)
pccaModel_finale
anova.cca(pccaModel_finale)
anova(pccaModel_finale, by="terms", perms.max=1000)
pccaModel_finale$CCA$biplot
plot(pccaModel_finale, type="n", scaling =3)
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
text(pccaModel_finale, "species", col="blue", cex=0.8)
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
data_env_sans_alt <- data_environment %>%
as.data.frame() %>%
select(-Altitude)
head(data_env_sans_alt)
# Calcul de la matrice de distance spatiale
matrice_spatial <- dist(data_coordinate) # Matrice spatiale
# Calcul de la matrice de distance du milieu (standardisée)
matrice_env_sans_alt <- dist(data_env_sans_alt, method = "euclidean") # Matrice du milieu
# Test de Mantel
R <- mantel.randtest(matrice_spatial, matrice_env_sans_alt, nrepet = 10000)
# Affichage des résultats
R # p-value: 0.1418581, Observation: 0.04313656
plot(R, main = "Test de Mantel")
data_environmentAndCoord_sans_alt = cbind(data_env_sans_alt, data_coordinate)
formule_pcca_sans_alt <- formula(paste("data_flower ~",                              paste(names(data_environmentAndCoord_sans_alt)[1:(length(data_environmentAndCoord_sans_alt)-(length(data_coordinate)))], collapse = " + "), "+ Condition (", paste(names(data_environmentAndCoord_sans_alt)[(length(data_environmentAndCoord_sans_alt)-(length(data_coordinate)-1)):length(data_environmentAndCoord_sans_alt)], collapse ="+"),")"))
print(formule_pcca_sans_alt)
pccaModel_sans_alt <- cca(formule_pcca_sans_alt, data_environmentAndCoord_sans_alt,scan=F)
ordistep(pccaModel_sans_alt,perm.max=500)
formulePcca_finale_sans_alt = formula("data_flower ~ Sable + K + Conduc + Capa_Reten +
Condition(x + y)")
pccaModel_finale <- cca(formulePcca_finale_sans_alt, data_environmentAndCoord_sans_alt,scan=F)
vif.cca(formulePcca_finale_sans_alt)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(readxl)
library(vegan)
library(dplyr)
library(ggplot2)
library(corrplot)
library(PerformanceAnalytics)
library(ade4)
Path = "data_vegetation_french.xls"
data_flower <- read_xls(Path, sheet = "flo")
data_environment <- read_xls(Path, sheet = "mil") %>%
lapply(as.numeric) %>%
as.data.frame()
colnames(data_environment) <- c("Argile","Limon","Sable","K2O","Mg", "Na_100g","K", "Conduc","Capa_Reten","Na_Liter","Altitude"  )
data_coordinate <- read_xls(Path, sheet = "coord") %>%
lapply(as.numeric) %>%
as.data.frame()
data_association <- read_xls(Path, sheet = "association")
summary(data_association)
summary(data_coordinate)
summary(data_flower[, 1:3])
summary(data_environment)
#ok
colSums(is.na(data_flower))
colSums(is.na(data_environment))
#ok
apply(data_flower, 1, sum)
#ok
par(mfrow=c(2,2))
for (i in 1:ncol(data_environment)) {
boxplot(data_environment[,i],col='blue',ylab=colnames(data_environment)[i])
dotchart(data_environment[,i],pch=16,col='blue',xlab=colnames(data_environment)[i])
hist(data_environment[,i],col='blue',xlab=colnames(data_environment)[i], main = "")
qqnorm(data_environment[,i],pch=16,col='blue')
qqline(data_environment[,i],col='red')
}
#matrice de corrélation des variables environnementales
chart.Correlation(data_environment)
boxplot(data_environment$Conduc~as.factor(data_environment$Altitude),
ylab = "Conductivité",
xlab = "Altitude")
data_environment <- data_environment[,-c(1,6,10)]
#data_environment <- data_environment[,- 8]
data_environment <- scale(data_environment,center = T, scale = T)
barplot(table(as.vector(unlist(as.vector(data_flower)))), xlab = "Abondance", ylab = "Fréquence", col = "blue")
hist(apply(data_flower, 1, sum),col='blue', main="", xlab = "Total de plantes par station")
hist(apply(data_flower, 2, sum),col='blue', main="", xlab = "Nombre d'individus d'une même espèce (toute station confondue)")
data_flower <- decostand(data_flower, "hellinger")
plot(data_coordinate)
# Calcul de la matrice de distance spatiale
matrice_spatial <- dist(data_coordinate) # Matrice spatiale
# Calcul de la matrice de distance du milieu (standardisée)
matrice_env<- dist(data_environment, method = "euclidean") # Matrice du milieu
# Test de Mantel
R <- mantel.randtest(matrice_spatial, matrice_env, nrepet = 10000)
# Affichage des résultats
R # p-value: 0.1418581, Observation: 0.04313656
plot(R, main = "Test de Mantel")
data_environmentAndCoord = cbind(data_environment, data_coordinate)
formule_pcca <- formula(paste("data_flower ~",                              paste(names(data_environmentAndCoord)[1:(length(data_environmentAndCoord)-(length(data_coordinate)))], collapse = " + "), "+ Condition (", paste(names(data_environmentAndCoord)[(length(data_environmentAndCoord)-(length(data_coordinate)-1)):length(data_environmentAndCoord)], collapse ="+"),")"))
print(formule_pcca)
pccaModel <- cca(formule_pcca, data_environmentAndCoord,scan=F)
ordistep(pccaModel,perm.max=500)
formulePcca_finale = formula("data_flower ~ Sable + Mg + K + Conduc + Capa_Reten + Altitude +
Condition(x + y)")
pccaModel_finale <- cca(formulePcca_finale, data_environmentAndCoord,scan=F)
vif.cca(pccaModel_finale)
pccaModel_finale
anova.cca(pccaModel_finale)
anova(pccaModel_finale, by="terms", perms.max=1000)
pccaModel_finale$CCA$biplot
plot(pccaModel_finale, type="n", scaling =3)
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
text(pccaModel_finale, "species", col="blue", cex=0.8)
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord, colvec[association]))
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
data_env_sans_alt <- data_environment %>%
as.data.frame() %>%
select(-Altitude)
head(data_env_sans_alt)
# Calcul de la matrice de distance spatiale
matrice_spatial <- dist(data_coordinate) # Matrice spatiale
# Calcul de la matrice de distance du milieu (standardisée)
matrice_env_sans_alt <- dist(data_env_sans_alt, method = "euclidean") # Matrice du milieu
# Test de Mantel
R <- mantel.randtest(matrice_spatial, matrice_env_sans_alt, nrepet = 10000)
# Affichage des résultats
R # p-value: 0.1418581, Observation: 0.04313656
plot(R, main = "Test de Mantel")
data_environmentAndCoord_sans_alt = cbind(data_env_sans_alt, data_coordinate)
formule_pcca_sans_alt <- formula(paste("data_flower ~",                              paste(names(data_environmentAndCoord_sans_alt)[1:(length(data_environmentAndCoord_sans_alt)-(length(data_coordinate)))], collapse = " + "), "+ Condition (", paste(names(data_environmentAndCoord_sans_alt)[(length(data_environmentAndCoord_sans_alt)-(length(data_coordinate)-1)):length(data_environmentAndCoord_sans_alt)], collapse ="+"),")"))
print(formule_pcca_sans_alt)
pccaModel_sans_alt <- cca(formule_pcca_sans_alt, data_environmentAndCoord_sans_alt,scan=F)
ordistep(pccaModel_sans_alt,perm.max=500)
formulePcca_finale_sans_alt = formula("data_flower ~ Sable + K + Conduc + Capa_Reten +
Condition(x + y)")
pcca_finale_sans_alt <- cca(formulePcca_finale_sans_alt, data_environmentAndCoord_sans_alt,scan=F)
vif.cca(pcca_finale_sans_alt)
formulePcca_finale_sans_alt
anova.cca(pcca_finale_sans_alt)
anova(pcca_finale_sans_alt, by="terms", perms.max=1000)
pcca_finale_sans_alt$CCA$biplot
plot(pcca_finale_sans_alt, type="n", scaling =3)
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
text(pcca_finale_sans_alt, "species", col="blue", cex=0.8)
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
#head(with(data_environmentAndCoord_sans_alt, colvec[association]))
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
scl <- 2
colvec <- c("darkred", "darkblue", "darkgreen","darkorange","darkmagenta","darkcyan","darkgrey")
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord_sans_alt$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pcca_finale_sans_alt, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pcca_finale_sans_alt, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord_sans_alt, points(pcca_finale_sans_alt, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord_sans_alt, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
association = unique(data_association$association) %>%
as.factor()
data_environmentAndCoord$association <- as.factor(data_association$association)
# Ajouter les axes sans les points :
plot(pccaModel_finale, type = "n", scaling = scl)
# Ajouter les fleches pour les variables environnementales :
text(pccaModel_finale, dis="cn",col="black",cex = 1.2)
# Ajouter les points (1 point = 1 ligne = 1 site)
with(data_environmentAndCoord, points(pccaModel_finale, display = "sites", col = colvec[association],
scaling = scl, pch = 21, bg = colvec[association]))
# Ajout des especes : (ça fait charge)
#text(pccaModel_finale, display = "species", scaling = scl, cex = 0.8, col = "darkcyan")
# Ajout d'une legende pour les couleurs :
with(data_environmentAndCoord, legend("topright", legend = levels(association), bty = "n",
col = colvec, pch = 21, pt.bg = colvec))
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message = FALSE)
data_environmentAndCoord = cbind(data_environment, data_coordinate)
